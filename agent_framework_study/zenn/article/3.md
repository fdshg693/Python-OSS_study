# get_response

get_responseはmessagesとして「str | ChatMessage | list[str] | list[ChatMessage]」を受け取ります
STRで簡単に呼べること、会話履歴を利用する際は当然Listが必要ですが、不要な場合はただSTRで呼べることが分かります。
今回は最もシンプルにSTRでmessagesに渡しています。
また、get_responseはBaseChatClientのメソッドであり、AzureOpenAIChatClient等はこのBaseChatClientを継承しています。

get_responseメソッド内では、prepare_messagesを使ってmessagesの型をlist[ChatMessage]に変換しています。
その後、「self._inner_get_response」にmessagesを渡して実際の応答生成を行っています。

_inner_get_responseはBaseChatClientクラスの抽象メソッドとして定義されています。
AzureOpenAIChatClientクラス自体は_inner_get_responseを定義していないのですが、OpenAIBaseChatClientを継承しているため、OpenAIBaseChatClientクラスで定義されている_inner_get_responseが呼ばれます。

_prepare_optionsでmessagesとchat_optionsからオプションを生成しているが、今の単純な例では、シンプルにmessagesを格納しているだけです。

「self.client.chat.completions.create(stream=False, **options_dict)」この箇所で、実際にAzure OpenAIのAPIを呼び出しています。
**options_dictの中にもとのmessagesが含まれています。

返ってきた結果を「self._create_chat_response」でつつむことで、ChatResponse型として返しています。

リソース
- AzureOpenAIChatClientインスタンス
    - .venv\Lib\site-packages\agent_framework\azure\_chat_client.py
- BaseChatClientインスタンス
    - .venv\Lib\site-packages\agent_framework\_clients.py
- OpenAIBaseChatClientインスタンス
    - .venv\Lib\site-packages\agent_framework\openai\_chat_client.py